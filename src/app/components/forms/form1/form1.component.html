<form [formGroup]="step1Group">
  <div class="form-grid">
    <!-- First column -->
    <div class="form-column">
      <mat-form-field class="full-width compact-form-field">
        <mat-label>Number</mat-label>
        <input
          matInput
          formControlName="demand_number"
          [defaultValue]="1"
          readonly
        />
      </mat-form-field>
      <mat-form-field class="full-width compact-form-field">
        <mat-label>Work ID</mat-label>
        <input matInput formControlName="demand_workId" required />
        <mat-error
          *ngIf="step1Group.get('demand_workId')?.hasError('required')"
        >
          Work ID is required
        </mat-error>
      </mat-form-field>
      <div class="compact-form-field full-width">
        <app-reference-field
          [fetchData]="fyUtils.getDataFetcher()"
          [labelField]="fyUtils.getLabelField()"
          [(selectedItem)]="fyUtils.selectedItem"
        ></app-reference-field>
      </div>
      <mat-form-field class="full-width compact-form-field">
        <mat-label>Request Date</mat-label>
        <input
          matInput
          [matDatepicker]="requestDatePicker"
          formControlName="demand_requestDate"
        />
        <mat-datepicker-toggle
          matSuffix
          [for]="requestDatePicker"
        ></mat-datepicker-toggle>
        <mat-datepicker #requestDatePicker></mat-datepicker>
      </mat-form-field>
      <mat-form-field class="full-width compact-form-field">
        <mat-label>Proposal Amount</mat-label>
        <input matInput formControlName="demand_proposalAmount" required />
      </mat-form-field>
      <mat-form-field class="full-width compact-form-field">
        <mat-label>Proposal Date</mat-label>
        <input
          matInput
          [matDatepicker]="proposalDatePicker"
          formControlName="demand_proposalDate"
        />
        <mat-datepicker-toggle
          matSuffix
          [for]="proposalDatePicker"
        ></mat-datepicker-toggle>
        <mat-datepicker #proposalDatePicker></mat-datepicker>
      </mat-form-field>
      <mat-form-field class="full-width compact-form-field">
        <mat-label>Demand Number</mat-label>
        <input matInput formControlName="demand_dmndNumber" required />
      </mat-form-field>
      <mat-form-field class="full-width compact-form-field">
        <mat-label>Proposer Name</mat-label>
        <input matInput formControlName="demand_proposerName" required />
      </mat-form-field>

      <mat-form-field class="full-width compact-form-field">
        <mat-label>Work Description</mat-label>
        <textarea
          matInput
          formControlName="demand_workDescription"
          required
        ></textarea>
      </mat-form-field>
    </div>
    <!-- First column finished-->

    <!-- Second column -->
    <div class="form-column">
      <mat-form-field class="full-width compact-form-field">
        <mat-label>Scheme Name</mat-label>
        <input matInput formControlName="demand_schemeName" required />
      </mat-form-field>
      <div class="compact-form-field full-width">
        <app-reference-field
          [fetchData]="fundUtils.getDataFetcher()"
          [labelField]="fundUtils.getLabelField()"
          [(selectedItem)]="fundUtils.selectedItem"
        ></app-reference-field>
      </div>
      <mat-form-field class="full-width compact-form-field">
        <mat-label>MP/MLA Name</mat-label>
        <input matInput formControlName="demand_MpMlaName" required />
      </mat-form-field>
      <mat-form-field class="full-width compact-form-field">
        <mat-label>Estimation Completion Date</mat-label>
        <input
          matInput
          [matDatepicker]="estimatedCompletionDatePicker"
          formControlName="demand_estimatedCompletionDate"
        />
        <mat-datepicker-toggle
          matSuffix
          [for]="estimatedCompletionDatePicker"
        ></mat-datepicker-toggle>
        <mat-datepicker #estimatedCompletionDatePicker></mat-datepicker>
      </mat-form-field>
      <mat-form-field class="full-width compact-form-field">
        <mat-label>Importance of Work</mat-label>
        <input matInput formControlName="demand_importanceOfWork" required />
      </mat-form-field>
      <div class="compact-form-field full-width">
        <app-reference-field
          [fetchData]="sectorUtils.getDataFetcher()"
          [labelField]="sectorUtils.getLabelField()"
          [(selectedItem)]="sectorUtils.selectedItem"
        ></app-reference-field>
      </div>
      <div class="compact-form-field full-width">
        <app-reference-field
          [fetchData]="subsectorUtils.getDataFetcher()"
          [labelField]="subsectorUtils.getLabelField()"
          [(selectedItem)]="subsectorUtils.selectedItem"
        ></app-reference-field>
      </div>

      <div class="compact-form-field full-width">
        <label class="mat-label">Trust?</label>
        <mat-checkbox formControlName="demand_isTrust"></mat-checkbox>
      </div>
      @if (step1Group.get('demand_isTrust')?.value) {
      <mat-form-field class="full-width compact-form-field">
        <mat-label>Trust Name</mat-label>
        <input matInput formControlName="demand_trustName" required />
      </mat-form-field>
      <mat-form-field class="full-width compact-form-field">
        <mat-label>Trust Address</mat-label>
        <input matInput formControlName="demand_trustAddress" required />
      </mat-form-field>
      <mat-form-field class="full-width compact-form-field">
        <mat-label>Trust Registration Number</mat-label>
        <input
          matInput
          formControlName="demand_trustRegistrationNumber"
          required
        />
      </mat-form-field>
      <mat-form-field class="full-width compact-form-field">
        <mat-label>Trust Registration Date</mat-label>
        <input
          matInput
          formControlName="demand_trustRegistrationDate"
          required
        />
      </mat-form-field>
      }
    </div>
    <div class="form-column">
      <mat-form-field class="full-width compact-form-field">
        <mat-label>Demand Officer</mat-label>
        <input matInput formControlName="demand_officer" />
      </mat-form-field>
      <mat-form-field class="full-width compact-form-field">
        <mat-label>Assign PS To</mat-label>
        <input matInput formControlName="demand_assignPSTo" required />
      </mat-form-field>

      <mat-form-field class="full-width compact-form-field">
        <mat-label>Implementation Officer</mat-label>
        <input
          matInput
          formControlName="demand_implementationOfficer"
          required
        />
      </mat-form-field>

      <div class="compact-form-field full-width">
        <app-reference-field
          [fetchData]="districtUtils.getDataFetcher()"
          [labelField]="districtUtils.getLabelField()"
          [(selectedItem)]="districtUtils.selectedItem"
        ></app-reference-field>
      </div>
      <div class="compact-form-field full-width">
        <app-reference-field
          formControlName="demand_beneficiaryTaluka"
          [fetchData]="talukaUtils.getDataFetcher()"
          [labelField]="talukaUtils.getLabelField()"
          [(selectedItem)]="talukaUtils.selectedItem"
        ></app-reference-field>
      </div>
      <div class="full-width compact-form-field">
        <label class="mat-label">Beneficiary Area Type</label>
        <mat-radio-group formControlName="demand_beneficiaryAreaType">
          <mat-radio-button value="urban">Urban</mat-radio-button>
          <mat-radio-button value="village">Village</mat-radio-button>
        </mat-radio-group>
      </div>
      @if (step1Group.get('demand_beneficiaryAreaType')?.value == 'village') {
      <div class="compact-form-field full-width">
        <app-reference-field
          [fetchData]="gpVillageUtils.getDataFetcher()"
          [labelField]="gpVillageUtils.getLabelField()"
          [(selectedItem)]="gpVillageUtils.selectedItem"
        ></app-reference-field>
      </div>
      } @else {<mat-form-field class="full-width compact-form-field">
        <mat-label>Beneficiary Nagarpalika</mat-label>
        <input
          matInput
          formControlName="demand_beneficiaryNagarpalika"
          required
        /> </mat-form-field
      >}
      <div class="compact-form-field full-width">
        <app-reference-field
          [fetchData]="bgUtils.getDataFetcher()"
          [labelField]="bgUtils.getLabelField()"
          [(selectedItem)]="bgUtils.selectedItem"
        ></app-reference-field>
      </div>
      <div class="full-width compact-form-field">
        <label class="mat-label">Demand Status</label>
        <mat-radio-group formControlName="demand_demandStatus">
          <mat-radio-button value="draft">Draft</mat-radio-button>
          <mat-radio-button value="submit">Submit</mat-radio-button>
        </mat-radio-group>
      </div>
      <div class="compact-form-field right-aligned-container">
        <button mat-raised-button (click)="goNext()" color="primary">
          Submit
        </button>
      </div>
    </div>
  </div>
</form>
